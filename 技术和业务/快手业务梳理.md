## 技术项目

### 微前端

* 背景
    * 小店工作台为react单页应用SPA，其中分销、物流管理归分销团队维护，但位于单一工程中，跨团队开发、部署上线有冲突，影响开发效率和研发质量，需要进行拆分
    * 电商分销工作台旧工程为vue，电商前端转向react，需要保证平稳过渡，一段时间内维护两套技术栈

* 目的
    * 实现单一平台中多框架并存，独立开发、部署、上线
    * 因为要求用户体验比较高，不采用iframe接入


* 方案
    * 基于qiankun 的微前端解决方案
    * 封装了react、vue版本的SDK，支持两种框架的主子应用快速接入
    * 提供了微前端开发脚手架工具，子应用内一键启动微前端调试模式，提高本地开发调试效率
    * 提供了微前端管理平台，与公司的部署平台打通，用于管理微前端主子应用的权限、关联、部署生效


* 收益
    * 完成了PC工作台的应用拆分，单一工程拆分为多个独立工程，分团队独立维护，独立开发、部署
    * 支持在vue主应用内，使用react开发新功能，以子应用接入，实现了多框架并存以及独立开发部署，并保证良好的SPA单页应用体验



### 跨框架组件库 svelte

* 背景
    * 同一业务多个子平台，分别是vue和react，需要复用一些业务组件，例如：消息弹窗、认证弹窗、权限提示等
    * 团队不鼓励继续使用vue开发新功能，要求全面转向react
    * 多框架分别开发业务组件，重复开发，效率低，收益不大


* 目的
    * 只需要开发一套组件，跨框架多平台复用
    * 实现所谓的 一码多端（vue、react）


* 方案
    * 采用编译型，无virtual dom的框架svelte来开发业务组件
    * 语法类似vue，支持响应式，编译时完成依赖收集
    * 上手成本低，基础库体积小，适合开发体积较小、功能单一的组件
    * 比纯原生js开发组件，成本要低，而且现有工具体系支持编译为各种格式，包括web component，可以天然跨框架使用
    * 团队内之前已有一些探索，但未在生产环境应用


* 收益
    * 开发了十多个业务组件，在分销PC工作台生产环境上线使用，解决了跨框架（vue、react）组件复用问题
    * 同时跟后端约定了一套组件化协议，支持一定程度的灵活配置和能力扩展，减少前端重复开发


### 端内H5前端异常监控录屏回放

* 背景
    * 现有的前端监控方案，主要是基于sentry和自研的监控平台，主要手段是接口监控、前端错误监控
    * 展现形式主要是可视化图表，异常错误相关源码信息
    * 缺少完整还原用户真实环境的信息，只能靠经验基于分散的报错信息来反向推断，排查效率低下

* 目的
    * 能够精确捕捉前端异常错误发生时真实的用户环境和行为操作、网络请求数据
    * 能够精确还原错误发生时的场景，而不是只靠研发自己在本地或者测试环境去调试、验证
    * 尽量减少对用户的干扰，以及减少对页面核心体验的影响

* 方案
    * 有感录屏回放方案
        1. 基于 WebRTC的音视频流实现web页面录屏和回放
            录屏开始时，会有弹窗或者工具条显性提示用户，并让用户选择是否开启录屏
            支持实时的音视频流记录，以及传输，可以实时排查问题

        2. 基于native app的录屏能力，通知H5页面开启录屏
            基于现有的信令平台，建立录屏任务，使用app扫码或者其他方式开启录屏
            由native app通知H5当前是否在录屏流程中

    * 无感录屏回放方案
        1. 基于canvas快照的截屏方案
            按照一定时间间隔，使用canvas根据当前页面dom绘制图片
            多张图片按照时间戳串联起来，相当于视频录屏效果
            可使用现有的 html2canvas

        2. 基于DOM快照（以及 mutation observer）的纯web录屏方案（例如：开源的 rrweb）
            页面初始化全量dom快照，可序列化位类似虚拟dom的特定json数据
            对序列化后的DOM节点，生成唯一的ID，用于后续的节点关联功能
            页面变更时，通过 [MutationObserver](https://developer.mozilla.org/zh-CN/docs/Web/API/MutationObserver) 对DOM变更监控，生成增量DOM快照
            对特定的HTML 表单类元素，获取其value，
            批量或者特定时间间隔，上传对应时间戳的DOM快照数据

            回放时，在iframe沙箱内按照时间戳反序列化DOM快照json数据，渲染对应的html页面

* 收益
    * 与客户端团队共建产出了端内H5的前端录屏和回放方案，基于xpath 和 原生事件劫持
    * 完成了Android端方案设计和demo实现
    * iOS端未完成


### 运营侧可视化搭建

* 背景
    电商运营平台模块需要按照业务方向拆分，独立维护

* 目的
    从单一的巨石应用工程拆分为多个可独立开发部署的子应用
    多技术栈并存
    对用户体验要求不高，关注开发效率，交付效率

* 方案
    1. 基于qiankun的微前端方案
    2. 引入低代码平台搭建能力，一般页面由外包、实习生搭建，解放正式员工人力资源
    3. 引入前后端一体化组件协议方案，支持后端按照一定的规则和协议，灵活配置表单、表格、图表等，减少前端开发的介入

* 收益


## 业务价值

### 站内分销

* 收益
    人货撮合工具能力建设，包括PC工作台微前端重构、申样管理、计划管理，以及商家、达人基础工具的建设
    人找货核心平台，选品中心，经历UI 2.0改版、智能组货、达人邀约、0元申样重构等，访问用户数由10W级别翻倍达到20W+
    动销比例提升20%+


### 站外分销 —— 快赚客

* 收益
    站外分销（微信生态）从0到1建设，站外分销GMV由0起步，月GMV达到千万以上

### 招商入驻

* 收益
    完善商家入驻、升级、降级、清退、关店流程，实现从线下到线上自动化

### 服务商

* 收益


### 供应链 —— 电子面单

* 收益
    快递商家接入率达到近90%，接近竞品，还需要继续追赶

### 供应链 —— 仓储管理平台重构

* 收益
    结算体系从0到1，建立面向商家、服务商的线上结算体系

