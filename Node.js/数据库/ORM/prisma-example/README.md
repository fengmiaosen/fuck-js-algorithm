# Prisma å®Œæ•´é¡¹ç›®ç¤ºä¾‹

è¿™æ˜¯ä¸€ä¸ªä½¿ç”¨ Prisma æ„å»ºçš„å®Œæ•´åšå®¢ç³»ç»Ÿç¤ºä¾‹ï¼Œå±•ç¤ºäº† Prisma çš„æ ¸å¿ƒåŠŸèƒ½å’Œæœ€ä½³å®è·µã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
npm install
```

### 2. ç¯å¢ƒé…ç½®

å¤åˆ¶ç¯å¢ƒå˜é‡ç¤ºä¾‹æ–‡ä»¶ï¼š

```bash
cp .env.example .env
```

ç¼–è¾‘ `.env` æ–‡ä»¶ï¼Œé…ç½®ä½ çš„æ•°æ®åº“è¿æ¥ï¼š

```env
DATABASE_URL="postgresql://username:password@localhost:5432/prisma_example"
```

### 3. æ•°æ®åº“è®¾ç½®

```bash
# ç”Ÿæˆ Prisma å®¢æˆ·ç«¯
npm run db:generate

# è¿è¡Œæ•°æ®åº“è¿ç§»
npm run db:migrate:dev

# å¡«å……ç¤ºä¾‹æ•°æ®
npm run db:seed
```

### 4. å¯åŠ¨åº”ç”¨

```bash
# å¼€å‘æ¨¡å¼
npm run dev

# ç”Ÿäº§æ¨¡å¼
npm run build
npm start
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
prisma-example/
â”œâ”€â”€ prisma/
â”‚   â”œâ”€â”€ schema.prisma          # æ•°æ®åº“æ¨¡å¼å®šä¹‰
â”‚   â”œâ”€â”€ seed.ts               # æ•°æ®åº“ç§å­æ–‡ä»¶
â”‚   â””â”€â”€ migrations/           # æ•°æ®åº“è¿ç§»æ–‡ä»¶
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â””â”€â”€ prisma.ts         # Prisma å®¢æˆ·ç«¯é…ç½®
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ userService.ts    # ç”¨æˆ·æœåŠ¡å±‚
â”‚   â”‚   â””â”€â”€ postService.ts    # æ–‡ç« æœåŠ¡å±‚
â”‚   â””â”€â”€ index.ts             # åº”ç”¨å…¥å£
â”œâ”€â”€ package.json
â”œâ”€â”€ .env.example             # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â””â”€â”€ README.md
```

## ğŸ—„ï¸ æ•°æ®åº“æ¨¡å‹

### æ ¸å¿ƒæ¨¡å‹

- **User** - ç”¨æˆ·æ¨¡å‹ï¼ˆæ”¯æŒè§’è‰²ã€èµ„æ–™ã€å…³æ³¨å…³ç³»ï¼‰
- **Post** - æ–‡ç« æ¨¡å‹ï¼ˆæ”¯æŒåˆ†ç±»ã€æ ‡ç­¾ã€ç‚¹èµã€è¯„è®ºï¼‰
- **Comment** - è¯„è®ºæ¨¡å‹ï¼ˆæ”¯æŒåµŒå¥—å›å¤ï¼‰
- **Category** - åˆ†ç±»æ¨¡å‹
- **Tag** - æ ‡ç­¾æ¨¡å‹
- **Like** - ç‚¹èµæ¨¡å‹
- **Follow** - å…³æ³¨å…³ç³»æ¨¡å‹

### å…³ç³»è®¾è®¡

- ç”¨æˆ·ä¸æ–‡ç« ï¼šä¸€å¯¹å¤šå…³ç³»
- æ–‡ç« ä¸åˆ†ç±»ï¼šå¤šå¯¹ä¸€å…³ç³»
- æ–‡ç« ä¸æ ‡ç­¾ï¼šå¤šå¯¹å¤šå…³ç³»
- ç”¨æˆ·ä¸ç”¨æˆ·ï¼šå¤šå¯¹å¤šå…³æ³¨å…³ç³»
- æ”¯æŒåµŒå¥—è¯„è®ºå’Œç‚¹èµåŠŸèƒ½

## ğŸ› ï¸ å¯ç”¨è„šæœ¬

### æ•°æ®åº“æ“ä½œ

```bash
# ç”Ÿæˆ Prisma å®¢æˆ·ç«¯
npm run db:generate

# å¼€å‘ç¯å¢ƒè¿ç§»ï¼ˆåˆ›å»ºå¹¶åº”ç”¨è¿ç§»ï¼‰
npm run db:migrate:dev

# ç”Ÿäº§ç¯å¢ƒè¿ç§»ï¼ˆä»…åº”ç”¨è¿ç§»ï¼‰
npm run db:migrate:deploy

# é‡ç½®æ•°æ®åº“ï¼ˆå±é™©æ“ä½œï¼‰
npm run db:migrate:reset

# å¡«å……ç¤ºä¾‹æ•°æ®
npm run db:seed

# å¯åŠ¨ Prisma Studio
npm run db:studio

# æ¨é€ schema å˜æ›´ï¼ˆåŸå‹å¼€å‘ï¼‰
npm run db:push

# ä»ç°æœ‰æ•°æ®åº“æ‹‰å– schema
npm run db:pull
```

### å¼€å‘å·¥å…·

```bash
# å¼€å‘æ¨¡å¼ï¼ˆçƒ­é‡è½½ï¼‰
npm run dev

# æ„å»ºé¡¹ç›®
npm run build

# å¯åŠ¨ç”Ÿäº§ç‰ˆæœ¬
npm start

# è¿è¡Œæµ‹è¯•
npm test

# ä»£ç æ£€æŸ¥
npm run lint

# ä»£ç æ ¼å¼åŒ–
npm run format
```

## ğŸ“Š ç¤ºä¾‹æ•°æ®

è¿è¡Œ `npm run db:seed` åï¼Œç³»ç»Ÿä¼šåˆ›å»ºä»¥ä¸‹æµ‹è¯•æ•°æ®ï¼š

### æµ‹è¯•è´¦æˆ·

- **ç®¡ç†å‘˜**: admin@example.com / password123
- **ç”¨æˆ·1**: john@example.com / password123  
- **ç”¨æˆ·2**: jane@example.com / password123

### ç¤ºä¾‹å†…å®¹

- 3ä¸ªç”¨æˆ·è´¦æˆ·ï¼ˆåŒ…å«å®Œæ•´èµ„æ–™ï¼‰
- 3ä¸ªæ–‡ç« åˆ†ç±»
- 8ä¸ªæ ‡ç­¾
- 3ç¯‡ç¤ºä¾‹æ–‡ç« 
- è¯„è®ºå’Œç‚¹èµæ•°æ®
- ç”¨æˆ·å…³æ³¨å…³ç³»

## ğŸ”§ æ ¸å¿ƒåŠŸèƒ½

### ç”¨æˆ·ç®¡ç†

- âœ… ç”¨æˆ·æ³¨å†Œå’Œç™»å½•
- âœ… ç”¨æˆ·èµ„æ–™ç®¡ç†
- âœ… è§’è‰²æƒé™æ§åˆ¶
- âœ… å…³æ³¨/å–æ¶ˆå…³æ³¨
- âœ… ç”¨æˆ·åˆ—è¡¨å’Œæœç´¢

### æ–‡ç« ç³»ç»Ÿ

- âœ… æ–‡ç« åˆ›å»ºå’Œç¼–è¾‘
- âœ… æ–‡ç« åˆ†ç±»å’Œæ ‡ç­¾
- âœ… æ–‡ç« å‘å¸ƒ/è‰ç¨¿çŠ¶æ€
- âœ… æ–‡ç« æœç´¢å’Œç­›é€‰
- âœ… æ–‡ç« æ’åºï¼ˆæœ€æ–°ã€çƒ­é—¨ã€æœ€å¤šç‚¹èµï¼‰
- âœ… ç›¸å…³æ–‡ç« æ¨è

### äº’åŠ¨åŠŸèƒ½

- âœ… æ–‡ç« ç‚¹èµ/å–æ¶ˆç‚¹èµ
- âœ… è¯„è®ºå’Œå›å¤ï¼ˆæ”¯æŒåµŒå¥—ï¼‰
- âœ… æµè§ˆé‡ç»Ÿè®¡
- âœ… ç”¨æˆ·åŠ¨æ€

### æ•°æ®åˆ†æ

- âœ… æ–‡ç« ç»Ÿè®¡ä¿¡æ¯
- âœ… ç”¨æˆ·æ´»è·ƒåº¦åˆ†æ
- âœ… çƒ­é—¨å†…å®¹æ’è¡Œ
- âœ… å®¡è®¡æ—¥å¿—è®°å½•

## ğŸ¯ æœ€ä½³å®è·µå±•ç¤º

### 1. ç±»å‹å®‰å…¨

- å®Œæ•´çš„ TypeScript ç±»å‹å®šä¹‰
- Prisma è‡ªåŠ¨ç”Ÿæˆçš„ç±»å‹
- æœåŠ¡å±‚æ¥å£è®¾è®¡

### 2. æ•°æ®åº“è®¾è®¡

- åˆç†çš„å…³ç³»è®¾è®¡
- ç´¢å¼•ä¼˜åŒ–
- æ•°æ®å®Œæ•´æ€§çº¦æŸ

### 3. æŸ¥è¯¢ä¼˜åŒ–

- é¿å… N+1 æŸ¥è¯¢é—®é¢˜
- ä½¿ç”¨ include å’Œ select ä¼˜åŒ–
- åˆ†é¡µå’Œæ¸¸æ ‡åˆ†é¡µ
- å¤æ‚æŸ¥è¯¢ç¤ºä¾‹

### 4. äº‹åŠ¡å¤„ç†

- æ•°æ®ä¸€è‡´æ€§ä¿è¯
- é”™è¯¯å›æ»šæœºåˆ¶
- å®¡è®¡æ—¥å¿—è®°å½•

### 5. é”™è¯¯å¤„ç†

- Prisma é”™è¯¯ç±»å‹å¤„ç†
- å‹å¥½çš„é”™è¯¯æ¶ˆæ¯
- æ—¥å¿—è®°å½•

### 6. æ€§èƒ½ä¼˜åŒ–

- è¿æ¥æ± é…ç½®
- æŸ¥è¯¢ä¼˜åŒ–
- ç¼“å­˜ç­–ç•¥

## ğŸ§ª æµ‹è¯•

é¡¹ç›®åŒ…å«å®Œæ•´çš„æµ‹è¯•ç¤ºä¾‹ï¼š

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
npm test

# ç›‘å¬æ¨¡å¼
npm run test:watch
```

æµ‹è¯•è¦†ç›–ï¼š
- æœåŠ¡å±‚å•å…ƒæµ‹è¯•
- æ•°æ®åº“æ“ä½œæµ‹è¯•
- é”™è¯¯å¤„ç†æµ‹è¯•

## ğŸš€ éƒ¨ç½²

### Docker éƒ¨ç½²

```bash
# æ„å»ºé•œåƒ
docker build -t prisma-example .

# è¿è¡Œå®¹å™¨
docker run -p 3000:3000 --env-file .env prisma-example
```

### ç”Ÿäº§ç¯å¢ƒ

1. è®¾ç½®ç”Ÿäº§ç¯å¢ƒå˜é‡
2. è¿è¡Œæ•°æ®åº“è¿ç§»ï¼š`npx prisma migrate deploy`
3. ç”Ÿæˆå®¢æˆ·ç«¯ï¼š`npx prisma generate`
4. å¯åŠ¨åº”ç”¨ï¼š`npm start`

## ğŸ“š å­¦ä¹ èµ„æº

- [Prisma å®˜æ–¹æ–‡æ¡£](https://www.prisma.io/docs)
- [Prisma Schema å‚è€ƒ](https://www.prisma.io/docs/reference/api-reference/prisma-schema-reference)
- [Prisma Client API](https://www.prisma.io/docs/reference/api-reference/prisma-client-reference)

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## ğŸ“„ è®¸å¯è¯

MIT License